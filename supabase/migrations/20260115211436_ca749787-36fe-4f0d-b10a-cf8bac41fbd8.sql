-- Create treatments table with all treatment information
CREATE TABLE public.treatments (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  slug TEXT NOT NULL UNIQUE,
  icon TEXT NOT NULL,
  title TEXT NOT NULL,
  short_description TEXT NOT NULL,
  full_description TEXT,
  features TEXT[] NOT NULL DEFAULT '{}',
  benefits TEXT[],
  process_steps TEXT[],
  duration TEXT,
  price_range TEXT,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- Enable RLS
ALTER TABLE public.treatments ENABLE ROW LEVEL SECURITY;

-- Allow public read access (treatments info is public)
CREATE POLICY "Treatments are publicly readable"
  ON public.treatments
  FOR SELECT
  USING (true);

-- Only admins can modify treatments
CREATE POLICY "Admins can manage treatments"
  ON public.treatments
  FOR ALL
  USING (has_role(auth.uid(), 'admin'::app_role))
  WITH CHECK (has_role(auth.uid(), 'admin'::app_role));

-- Add trigger for updated_at
CREATE TRIGGER update_treatments_updated_at
  BEFORE UPDATE ON public.treatments
  FOR EACH ROW
  EXECUTE FUNCTION public.update_updated_at_column();

-- Insert all treatments data from the website
INSERT INTO public.treatments (slug, icon, title, short_description, full_description, features, benefits, process_steps, duration, price_range) VALUES
(
  'general-dentistry',
  '🦷',
  'טיפולי שיניים כלליים',
  'טיפולים מונעים, סתימות, ניקוי שיניים מקצועי.',
  'טיפולי שיניים כלליים הם הבסיס לבריאות הפה שלכם. אנו מציעים מגוון רחב של טיפולים מונעים ומשמרים שמטרתם לשמור על השיניים והחניכיים בריאים לאורך שנים רבות. הצוות המקצועי שלנו משתמש בציוד מתקדם ובטכניקות עדכניות כדי להבטיח את הטיפול הטוב ביותר.',
  ARRAY['בדיקות תקופתיות', 'ניקוי מקצועי', 'סתימות לבנות', 'טיפולי חניכיים'],
  ARRAY['מניעת בעיות עתידיות', 'שמירה על בריאות הפה', 'חיסכון בעלויות טיפול', 'זיהוי מוקדם של בעיות'],
  ARRAY['בדיקה ראשונית ואבחון', 'צילום רנטגן במידת הצורך', 'תכנית טיפול מותאמת אישית', 'ביצוע הטיפול', 'מעקב ובקרה'],
  '30-60 דקות',
  '₪150 - ₪600'
),
(
  'teeth-whitening',
  '✨',
  'הלבנת שיניים',
  'טיפולי הלבנה מתקדמים לחיוך לבן וזוהר.',
  'הלבנת שיניים היא אחד הטיפולים הקוסמטיים הפופולריים ביותר במרפאה שלנו. אנו מציעים מגוון שיטות הלבנה מתקדמות המותאמות לצרכים האישיים של כל מטופל. התוצאות מרשימות ובטוחות, ומעניקות חיוך לבן וזוהר.',
  ARRAY['הלבנה במרפאה', 'ערכת הלבנה ביתית', 'הלבנה בלייזר', 'תוצאות מהירות'],
  ARRAY['חיוך לבן וזוהר', 'העלאת הביטחון העצמי', 'תוצאות מהירות', 'טיפול בטוח ויעיל'],
  ARRAY['ייעוץ ראשוני והתאמה', 'ניקוי שיניים מקצועי', 'ביצוע ההלבנה', 'הוראות טיפוח'],
  '60-90 דקות',
  '₪800 - ₪2,500'
),
(
  'dental-implants',
  '🔧',
  'שתלים דנטליים',
  'שתלי שיניים איכותיים עם אחוזי הצלחה גבוהים.',
  'שתלים דנטליים הם הפתרון המתקדם והקבוע ביותר להחלפת שיניים חסרות. המרפאה שלנו מתמחה בהשתלת שיניים באמצעות טכנולוגיות מתקדמות ושתלים מהמותגים המובילים בעולם. אחוזי ההצלחה שלנו גבוהים מאוד.',
  ARRAY['שתלים מתקדמים', 'תכנון מחשב', 'ריפוי מהיר', 'אחריות מלאה'],
  ARRAY['פתרון קבוע וארוך טווח', 'מראה טבעי', 'שיפור יכולת הלעיסה', 'שימור עצם הלסת'],
  ARRAY['ייעוץ ותכנון CT', 'השתלה כירורגית', 'תקופת ריפוי', 'התקנת כתר קבוע'],
  '1-2 שעות לשתל',
  '₪4,000 - ₪8,000 לשתל'
),
(
  'pediatric-dentistry',
  '👶',
  'רפואת שיניים לילדים',
  'טיפול עדין ומותאם לילדים.',
  'אנו מתמחים בטיפול בילדים מגיל הינקות ועד לגיל ההתבגרות. הצוות שלנו מיומן ביצירת חוויה חיובית לילדים, תוך שימוש בטכניקות הרגעה והתאמת הטיפול לגיל ולצרכים של כל ילד. המטרה שלנו היא לטפח יחס חיובי לטיפול שיניים.',
  ARRAY['סביבה ידידותית', 'טיפול עדין', 'הרדמה מותאמת', 'מניעה מוקדמת'],
  ARRAY['יצירת הרגלי היגיינה טובים', 'מניעת פחד מרופא שיניים', 'זיהוי מוקדם של בעיות', 'טיפול מותאם לגיל'],
  ARRAY['היכרות עם המרפאה', 'בדיקה עדינה', 'הסבר להורים ולילד', 'טיפול בשלבים'],
  '20-45 דקות',
  '₪100 - ₪400'
),
(
  'orthodontics',
  '😁',
  'יישור שיניים',
  'פתרונות אורתודנטיים מתקדמים.',
  'מחלקת האורתודונטיה שלנו מציעה פתרונות מתקדמים ליישור שיניים לכל הגילאים. אנו מתמחים בקשתיות שקופות (Invisalign), גשרים קבועים ושיטות יישור מודרניות נוספות. הטיפול מותאם אישית לכל מטופל.',
  ARRAY['קשתיות שקופות', 'גשרים קבועים', 'ריטיינרים', 'מעקב קבוע'],
  ARRAY['חיוך ישר ויפה', 'שיפור הנשיכה', 'ניקוי קל יותר', 'שיפור הביטחון העצמי'],
  ARRAY['ייעוץ ותכנון דיגיטלי', 'התקנת מכשיר', 'ביקורות תקופתיות', 'שימור התוצאות'],
  '12-24 חודשים',
  '₪8,000 - ₪25,000'
),
(
  'aesthetic-dentistry',
  '🏆',
  'אסתטיקה דנטלית',
  'ציפויי חרסינה, עיצוב חיוך.',
  'אסתטיקה דנטלית היא התמחות שמטרתה לשפר את מראה החיוך שלכם. אנו מציעים מגוון טיפולים אסתטיים כולל ציפויי חרסינה (ונירים), עיצוב חיוך מקיף, סגירת רווחים ושיקום אסתטי מלא. כל טיפול מתוכנן בקפידה להשגת תוצאות טבעיות ויפות.',
  ARRAY['ציפויי חרסינה', 'עיצוב חיוך', 'סגירת רווחים', 'שיקום אסתטי'],
  ARRAY['חיוך מושלם', 'תוצאות ארוכות טווח', 'מראה טבעי', 'העלאת הביטחון העצמי'],
  ARRAY['ייעוץ ותכנון דיגיטלי', 'הדמיה של התוצאה', 'הכנת השיניים', 'התקנת הציפויים'],
  '2-3 פגישות',
  '₪2,500 - ₪5,000 לשן'
);